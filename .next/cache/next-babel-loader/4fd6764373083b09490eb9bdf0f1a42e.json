{"ast":null,"code":"import { ReplaySubject } from 'rxjs';\nimport window from 'global';\nimport { useForm } from 'react-hook-form';\nimport { CAPTCHA_SITE_KEY_V3, CAPTCHA_SITE_KEY_V2, MOBILE_MAX_WIDTH } from './constants';\nexport const $gCaptchaResponseSubject = new ReplaySubject(null);\nexport const $gCaptchaResponseObs = $gCaptchaResponseSubject.asObservable();\nexport function captchaVerifyCallback(cresponse) {\n  // console.log('captchaVerifyCallback fired ', window['grecaptcha'].getResponse());\n  $gCaptchaResponseSubject.next(cresponse);\n} // var window;\n\nwindow['captchaSiteKey'] = null;\nwindow['onLoadCaptchaExplicitCallback'] = onLoadCaptchaExplicitHandler; // For new way of implementation of captcha code test\n// window.onload = function() {\n//     window.grecaptcha.ready(function() {\n//         console.log(\"google captcha ready event fired, rendering gRecaptchaElement\")\n//         window.grecaptcha.render(\"gRecaptchaElement\", {\n//           \"sitekey\": window['captchaSiteKey']\n//         });\n//       });\n// };\n\nexport function onLoadCaptchaExplicitHandler() {\n  console.log('onLoadCaptchaExplicitCallback callback fired');\n\n  if (!window['grecaptcha']) {\n    console.error('Not found grecaptcha object or g-recaptcha element not found ');\n    return;\n  }\n\n  if (document.getElementById('gRecaptchaElement')) {\n    window.grecaptcha.render('gRecaptchaElement', {\n      sitekey: window['captchaSiteKey'],\n      callback: captchaVerifyCallback\n    });\n  }\n\n  if (document.getElementById('captchaDesktop')) {\n    window.grecaptcha.render('captchaDesktop', {\n      sitekey: window['captchaSiteKey'],\n      callback: captchaVerifyCallback\n    });\n  }\n}\n;\nexport function reCaptchaInitialize(version) {\n  console.log('reCaptchaInitialize invoked!', version);\n  const ver = version.toLowerCase();\n  let renderScript;\n  let siteKey = ver === 'v3' ? CAPTCHA_SITE_KEY_V3 : CAPTCHA_SITE_KEY_V2; //  Before new implemenation old way of loading v2 recaptcha on load of script\n\n  renderScript = ver === 'v3' ? \"https://www.google.com/recaptcha/api.js?render=\" + siteKey : \"https://www.google.com/recaptcha/api.js?onload=onLoadCaptchaExplicitCallback&render=explicit\"; // For new way of captcha implemenation logic\n  // renderScript = ver === 'v3' ?\n  //     \"https://www.google.com/recaptcha/api.js?render=\" + siteKey : \"https://www.google.com/recaptcha/api.js\";\n\n  const dynamicScripts = [renderScript]; // For re-initialize captcha on different form switch on same page using dropdown option or link cliks (bascially in show hide scenario)\n\n  if (document.querySelector('[id*=\"gCaptchaDynamicScript_\"]')) document.querySelector('[id*=\"gCaptchaDynamicScript_\"]').remove(); // Before new implemenation\n  // if (document.querySelector('[id*=\"gCaptchaDynamicScript_\"]')) return;\n\n  for (let i = 0; i < dynamicScripts.length; i++) {\n    const node = document.createElement(\"script\");\n    node.id = 'gCaptchaDynamicScript_' + i;\n    node.src = dynamicScripts[i];\n    node.type = \"text/javascript\";\n    node.async = true;\n    node.defer = true;\n    node.charset = \"utf-8\";\n\n    node.onload = () => {\n      $gCaptchaResponseSubject.next(null);\n      if (!window['captchaSiteKey']) window['captchaSiteKey'] = siteKey;\n    };\n\n    document.getElementsByTagName(\"head\")[0].appendChild(node);\n  }\n}\nexport const verifyCaptcha = eleName => {\n  let validCaptcha = false; // this.recaptchaErrorFlag = false;\n\n  $gCaptchaResponseObs.subscribe(resp => {\n    if (resp) {\n      // console.log('captcha response received! ', resp );\n      // this.recaptchaErrorFlag = false;\n      validCaptcha = true;\n      this.value = resp;\n    } else {\n      // console.error('captcha response error! ', resp );\n      // this.recaptchaErrorFlag = true;\n      validCaptcha = false;\n      this.value = resp;\n    }\n  }, err => console.error('captcha response error! ', err));\n  return validCaptcha;\n};\nexport const isMobileDevice = () => {\n  // console.log(' (window.outerWidth <= MOBILE_MAX_WIDTH)',  window.outerWidth , (window.outerWidth <= MOBILE_MAX_WIDTH));\n  // return (typeof window.orientation !== \"undefined\") || (navigator.userAgent.indexOf('IEMobile') !== -1);\n  //return (window.outerWidth <= MOBILE_MAX_WIDTH) || (navigator.userAgent.indexOf('IEMobile') !== -1);\n  return window.outerWidth <= MOBILE_MAX_WIDTH;\n};\nexport const getCookie = cname => {\n  var name = cname + \"=\";\n  var ca = document.cookie.split(';');\n\n  for (var i = 0; i < ca.length; i++) {\n    var c = ca[i];\n\n    while (c.charAt(0) == ' ') {\n      c = c.substring(1);\n    }\n\n    if (c.indexOf(name) == 0) {\n      return c.substring(name.length, c.length);\n    }\n  }\n\n  return \"\";\n};\nexport function normalizeDate(date) {\n  // $date example \"20191125\" / \"YYYYMMDD\"\n  // use to convert $date into \"2019-11-25\" / \"YYYY-MM-DD\"\n  if (!date) return; // console.log('normalizeDate()', date, `${date.substr(0,4)}-${date.substr(4,2)}-${date.substr(6,2)}`)\n\n  return `${date.substr(0, 4)}-${date.substr(4, 2)}-${date.substr(6, 2)}`;\n}\nexport function isTextFound(name, searchText) {\n  // console.log('name ', name);\n  if (name && name.length) {\n    const serverTextMatch = name ? name.search(searchText) : -1;\n\n    if (serverTextMatch !== -1) {\n      // console.log('match found');\n      return false;\n    } else {\n      // console.log('not found');\n      return true;\n    }\n  }\n}","map":{"version":3,"sources":["/Users/jatinderbimra/work/xlbb/rsvp-next/util/index.js"],"names":["ReplaySubject","window","useForm","CAPTCHA_SITE_KEY_V3","CAPTCHA_SITE_KEY_V2","MOBILE_MAX_WIDTH","$gCaptchaResponseSubject","$gCaptchaResponseObs","asObservable","captchaVerifyCallback","cresponse","next","onLoadCaptchaExplicitHandler","console","log","error","document","getElementById","grecaptcha","render","sitekey","callback","reCaptchaInitialize","version","ver","toLowerCase","renderScript","siteKey","dynamicScripts","querySelector","remove","i","length","node","createElement","id","src","type","async","defer","charset","onload","getElementsByTagName","appendChild","verifyCaptcha","eleName","validCaptcha","subscribe","resp","value","err","isMobileDevice","outerWidth","getCookie","cname","name","ca","cookie","split","c","charAt","substring","indexOf","normalizeDate","date","substr","isTextFound","searchText","serverTextMatch","search"],"mappings":"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","sourcesContent":["import { ReplaySubject } from 'rxjs';\nimport window from 'global';\nimport { useForm } from 'react-hook-form';\nimport { CAPTCHA_SITE_KEY_V3, CAPTCHA_SITE_KEY_V2, MOBILE_MAX_WIDTH } from './constants';\n\n\nexport const $gCaptchaResponseSubject = new ReplaySubject(null);\nexport const $gCaptchaResponseObs = $gCaptchaResponseSubject.asObservable();\nexport function captchaVerifyCallback(cresponse) {\n    // console.log('captchaVerifyCallback fired ', window['grecaptcha'].getResponse());\n    $gCaptchaResponseSubject.next(cresponse);\n}\n// var window;\n\n    window['captchaSiteKey'] = null;\n    window['onLoadCaptchaExplicitCallback'] = onLoadCaptchaExplicitHandler;\n// For new way of implementation of captcha code test\n// window.onload = function() {\n//     window.grecaptcha.ready(function() {\n//         console.log(\"google captcha ready event fired, rendering gRecaptchaElement\")\n//         window.grecaptcha.render(\"gRecaptchaElement\", {\n//           \"sitekey\": window['captchaSiteKey']\n//         });\n//       });\n// };\n\nexport function onLoadCaptchaExplicitHandler() {\n    console.log('onLoadCaptchaExplicitCallback callback fired');\n\n    if (!window['grecaptcha']) {\n        console.error('Not found grecaptcha object or g-recaptcha element not found ');\n        return;\n    }\n\n    if (document.getElementById('gRecaptchaElement')) {\n        window.grecaptcha.render('gRecaptchaElement', {\n            sitekey: window['captchaSiteKey'],\n            callback: captchaVerifyCallback,\n        });\n    }\n\n    if (document.getElementById('captchaDesktop')) {\n        window.grecaptcha.render('captchaDesktop', {\n            sitekey: window['captchaSiteKey'],\n            callback: captchaVerifyCallback,\n        });\n    }\n};\n\nexport function reCaptchaInitialize(version) {\n    console.log('reCaptchaInitialize invoked!', version);\n    const ver = version.toLowerCase();\n    let renderScript;\n    let siteKey = ver === 'v3' ? CAPTCHA_SITE_KEY_V3 : CAPTCHA_SITE_KEY_V2;\n\n    //  Before new implemenation old way of loading v2 recaptcha on load of script\n    renderScript = ver === 'v3' ?\n        \"https://www.google.com/recaptcha/api.js?render=\" + siteKey : \"https://www.google.com/recaptcha/api.js?onload=onLoadCaptchaExplicitCallback&render=explicit\";\n\n    // For new way of captcha implemenation logic\n    // renderScript = ver === 'v3' ?\n    //     \"https://www.google.com/recaptcha/api.js?render=\" + siteKey : \"https://www.google.com/recaptcha/api.js\";\n\n    const dynamicScripts = [\n        renderScript\n    ];\n\n    // For re-initialize captcha on different form switch on same page using dropdown option or link cliks (bascially in show hide scenario)\n    if (document.querySelector('[id*=\"gCaptchaDynamicScript_\"]')) document.querySelector('[id*=\"gCaptchaDynamicScript_\"]').remove();\n    // Before new implemenation\n    // if (document.querySelector('[id*=\"gCaptchaDynamicScript_\"]')) return;\n\n    for (let i = 0; i < dynamicScripts.length; i++) {\n        const node = document.createElement(\"script\");\n        node.id = 'gCaptchaDynamicScript_' + i;\n        node.src = dynamicScripts[i];\n        node.type = \"text/javascript\";\n        node.async = true;\n        node.defer = true;\n        node.charset = \"utf-8\";\n        node.onload = () => {\n            $gCaptchaResponseSubject.next(null);\n            if (!window['captchaSiteKey']) window['captchaSiteKey'] = siteKey;\n        }\n\n        document.getElementsByTagName(\"head\")[0].appendChild(node);\n    }\n}\n\nexport const verifyCaptcha = (eleName) => {\n    let validCaptcha = false;\n    // this.recaptchaErrorFlag = false;\n\n    $gCaptchaResponseObs.subscribe((resp) => {\n\n      if (resp) {\n        // console.log('captcha response received! ', resp );\n        // this.recaptchaErrorFlag = false;\n        validCaptcha = true;\n        this.value = resp;\n      } else {\n        // console.error('captcha response error! ', resp );\n        // this.recaptchaErrorFlag = true;\n        validCaptcha = false;\n        this.value = resp;\n      }\n    },\n      err => console.error('captcha response error! ', err)\n    );\n\n    return validCaptcha;\n  }\n\nexport const isMobileDevice = () => {\n    // console.log(' (window.outerWidth <= MOBILE_MAX_WIDTH)',  window.outerWidth , (window.outerWidth <= MOBILE_MAX_WIDTH));\n    // return (typeof window.orientation !== \"undefined\") || (navigator.userAgent.indexOf('IEMobile') !== -1);\n    //return (window.outerWidth <= MOBILE_MAX_WIDTH) || (navigator.userAgent.indexOf('IEMobile') !== -1);\n    return (window.outerWidth <= MOBILE_MAX_WIDTH);\n};\n\nexport const getCookie = (cname) => {\n    var name = cname + \"=\";\n    var ca = document.cookie.split(';');\n    for (var i = 0; i < ca.length; i++) {\n        var c = ca[i];\n        while (c.charAt(0) == ' ') {\n            c = c.substring(1);\n        }\n        if (c.indexOf(name) == 0) {\n            return c.substring(name.length, c.length);\n        }\n    }\n    return \"\";\n}\n\nexport function normalizeDate(date) {\n    // $date example \"20191125\" / \"YYYYMMDD\"\n    // use to convert $date into \"2019-11-25\" / \"YYYY-MM-DD\"\n\n    if (!date) return\n    // console.log('normalizeDate()', date, `${date.substr(0,4)}-${date.substr(4,2)}-${date.substr(6,2)}`)\n    return `${date.substr(0, 4)}-${date.substr(4, 2)}-${date.substr(6, 2)}`;\n}\n\nexport function isTextFound(name, searchText) {\n    // console.log('name ', name);\n\n    if (name && name.length) {\n        const serverTextMatch = name ? name.search(searchText) : -1;\n        if (serverTextMatch !== -1) {\n            // console.log('match found');\n            return false;\n        } else {\n            // console.log('not found');\n            return true;\n        }\n    }\n}\n"]},"metadata":{},"sourceType":"module"}